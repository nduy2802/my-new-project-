;/*FB_PKG_DELIM*/

__d("Mp4MediaHeaderBox",[],(function(a,b,c,d,e,f){a=function(){function a(a,b){this.$1=b,b.getVersion()===1?(this.$2=a.readUint64(),this.$3=a.readUint64(),this.$4=a.readUint32(),this.$5=a.readUint64()):(this.$2=a.readUint32(),this.$3=a.readUint32(),this.$4=a.readUint32(),this.$5=a.readUint32())}var b=a.prototype;b.getTimescale=function(){return this.$4};b.getFullBox=function(){return this.$1};return a}();a.canonicalType="mdhd";f["default"]=a}),66);
__d("Mp4SampleDescriptionBox",[],(function(a,b,c,d,e,f){a=function(){function a(a,b){this.$2=a.readUint32(),this.$1=b}var b=a.prototype;b.getEntryCount=function(){return this.$2};b.getFullBox=function(){return this.$1};return a}();a.canonicalType="stsd";f["default"]=a}),66);
__d("OzSourceBufferTimeRangesControlledImpl",["oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=[],this.length=0,a!=null&&(this.$1=[].concat(a.$1),this.length=a.length)}var b=a.prototype;b.start=function(a){return this.$1[a].startTime};b.end=function(a){return this.$1[a].endTime};b.mergeRange=function(a){var b=a.startTime;a=a.endTime;b=b;a=a;var c=0,e=0;for(var f=0;f<this.$1.length;f++){var g=this.$1[f];if(g.startTime>=g.endTime)throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_TIME_RANGES",description:"mergeRange failed due to invalid range: {startTime: "+g.startTime+", endTime: "+g.endTime+"}"});if(b>g.endTime){c=f+1;continue}if(a<g.startTime)break;b=Math.min(b,g.startTime);a=Math.max(a,g.endTime);e++}g={startTime:b,endTime:a};this.$1.splice(c,e,g);this.length=this.$1.length};return a}();g["default"]=a}),98);
__d("OzVTTCache",["OzSourceBufferTimeRangesControlledImpl"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=[],this.$2=null,this.$3=new(c("OzSourceBufferTimeRangesControlledImpl"))()}var b=a.prototype;b.addCues=function(a){for(a of a)this.$4(a)};b.$4=function(a){var b=null,c=0;this.$2!=null&&a.startTime>=this.$2.time&&(c=this.$2.firstActiveCueIdx);for(c=c;c<this.$1.length;c++){var d=this.$1[c];if(this.$5(a,d))return;if(a.startTime<d.startTime||a.startTime===d.startTime&&a.endTime<d.endTime){b=c;break}}b=b==null?this.$1.length:b;if(this.$2!=null&&b<this.$2.firstActiveCueIdx){d=this.$2;c=d.time;d=d.firstActiveCueIdx;this.$2={time:c,firstActiveCueIdx:d+1}}this.$1.splice(b,0,a);this.$3.mergeRange(a)};b.$6=function(a){var b=[],c=0;this.$2!=null&&a>=this.$2.time&&(c=this.$2.firstActiveCueIdx);var d;for(c=c;c<this.$1.length;c++){var e=this.$1[c];if(a>=e.startTime&&a<e.endTime)d=d==null?c:d,e.text!=null&&b.push(e.text);else if(a<e.startTime)break}e=b[0];e!=null&&d!=null&&(this.$2={time:a,firstActiveCueIdx:d});return b};b.$5=function(a,b){return a.startTime===b.startTime&&a.endTime===b.endTime&&a.text===b.text};b.getLatestCaptions=function(){var a=this.$1[this.$1.length-1];return a!=null?this.getCaptionsForTime(a.startTime):null};b.getCaptionsForTime=function(a){a=this.$6(a);return a.length===0?null:{rows:a,styles:null}};b.getBuffered=function(){return new(c("OzSourceBufferTimeRangesControlledImpl"))(this.$3)};b.remove=function(a,b){var d=[],e=new(c("OzSourceBufferTimeRangesControlledImpl"))();this.$1.forEach(function(c){if(c.startTime>=a&&c.startTime<b)return;else d.push(c),e.mergeRange(c)});this.$1=d;this.$3=e;this.$2=null};return a}();g["default"]=a}),98);
__d("OzVTTSourceBufferImpl",["Mp4Demuxer","Mp4MediaHeaderBox","Mp4SampleDescriptionBox","Mp4TrackFragmentBaseMediaDecodeTimeBox","Mp4TrackFragmentHeaderBox","Mp4TrackRunBox","OzVTTCache","oz-player/shims/OzEventEmitter","oz-player/utils/OzCustomErrorCode","oz-player/utils/OzErrorUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=a.onCaptionsChanged;a=a.config;this.$2=!1;this.$3=new(c("oz-player/shims/OzEventEmitter"))();this.$4=!1;this.$5=null;this.$6=new(c("OzVTTCache"))();this.$7=b;this.$8=a}var b=a.prototype;b.changeType=function(a){return};b.$9=function(){this.$3.emit("updateEnd")};b.$10=function(){this.$3.emit("update")};b.registerOnUpdateListener=function(a){return this.$3.addListener("update",a)};b.registerOnErrorListener=function(a){return this.$3.addListener("error",a)};b.registerOnUpdateEndListener=function(a){return this.$3.addListener("updateEnd",a)};b.getIsUpdating=function(){return this.$2};b.getBuffered=function(){return this.$6.getBuffered()};b.setCurrentVideoTime=function(a){this.$1=a,this.$11()};b.setAppendWindowEnd=function(a){};b.appendBuffer=function(a){var b;if(a instanceof Uint8Array)b=a.buffer;else if(a instanceof ArrayBuffer)b=a;else{a;throw new Error("OzVTTSourceBufferImpl: data must be either Uint8Array or ArrayBuffer")}var e;try{if(this.$4&&this.$5!=null)e=i(b,this.$5);else{a=h(b);b=a.timeScale;a=a.wvttBoxReceived;this.$5=b!=null?b:this.$5;this.$4=this.$4||a}}catch(e){b=typeof e==="object"&&e!=null&&typeof e.name==="string"?e.name:"UnknownError";a=typeof e==="object"&&e!=null&&typeof e.message==="string"?e.message:String(e);throw d("oz-player/utils/OzErrorUtils").createOzError({type:"OZ_WEBVTT_CAPTION_PARSE_ERROR",description:"OzVTTSourceBufferImpl failed parsing caption segments. "+b+": "+a,extra:{originalError:e,code:c("oz-player/utils/OzCustomErrorCode").WEBVTT_CAPTION_PARSE_ERROR}})}e!=null&&(this.$6.addCues(e),this.$11());this.$10();this.$9()};b.abort=function(){this.$9()};b.remove=function(a,b){this.$6.remove(a,b),this.$10(),this.$9()};b.$11=function(){if(this.$1==null)return;var a=this.$6.getCaptionsForTime(this.$1);if(a!=null)this.$7(a);else{a=this.$6.getLatestCaptions();a!=null&&this.$7(a)}};return a}();function h(a){a=new DataView(a);a=new(c("Mp4Demuxer"))(a);var b={timeScale:null,wvttBoxReceived:!1},d=null;while(!a.atEnd()){var e=a.parseBox();switch(e.getType()){case"wvtt":b.wvttBoxReceived=!0;break;case c("Mp4MediaHeaderBox").canonicalType:d=a.parseCanonicalBox(c("Mp4MediaHeaderBox"),a.parseFullBox(e));if(!(d instanceof c("Mp4MediaHeaderBox")))return b;b.timeScale=d.getTimescale();a.skipBox(e);break;case"moov":case"trak":case"mdia":case"minf":case"stbl":break;case c("Mp4SampleDescriptionBox").canonicalType:a.parseCanonicalBox(c("Mp4SampleDescriptionBox"),a.parseFullBox(e));break;default:a.skipBox(e)}}return b}function i(a,b){a=new DataView(a);a=new(c("Mp4Demuxer"))(a);var d=null,e=null,f=null,g=null,h=null;while(!a.atEnd()){var i=a.parseBox();switch(i.getType()){case"moof":break;case"traf":break;case c("Mp4TrackFragmentBaseMediaDecodeTimeBox").canonicalType:h=a.parseCanonicalBox(c("Mp4TrackFragmentBaseMediaDecodeTimeBox"),a.parseFullBox(i));if(!(h instanceof c("Mp4TrackFragmentBaseMediaDecodeTimeBox")))return null;d=h.getBaseDecodeTime();a.skipBox(i);break;case c("Mp4TrackFragmentHeaderBox").canonicalType:h=a.parseCanonicalBox(c("Mp4TrackFragmentHeaderBox"),a.parseFullBox(i));if(!(h instanceof c("Mp4TrackFragmentHeaderBox")))return null;e=h.getDefaultSampleDuration();a.skipBox(i);break;case c("Mp4TrackRunBox").canonicalType:h=a.parseCanonicalBox(c("Mp4TrackRunBox"),a.parseFullBox(i));if(!(h instanceof c("Mp4TrackRunBox")))return null;f=h.getSamples();a.skipBox(i);break;case"mdat":if(d==null||f==null||f.length===0)return null;g=j({demuxer:a,baseMediaDecodeTime:d,defaultSampleDuration:e,sampleDescriptions:f,timescale:b});break;default:a.skipBox(i)}}return g}function j(a){var b=a.demuxer,c=a.baseMediaDecodeTime,d=a.defaultSampleDuration,e=a.sampleDescriptions;a=a.timescale;var f=[],g=c;for(e of e){var h=e.sampleCompositionTimeOffset,i=e.sampleDuration,j=e.sampleSize;i=(i=(i=i)!=null?i:d)!=null?i:0;if(i===0||j==null||j===0)break;h=h!=null?c+h:g;i=h+i;j=k({demuxer:b,sampleSize:j});for(j of j)f.push({text:j,startTime:h/a,endTime:i/a});g=i}return f}function k(a){var b=a.demuxer;a=a.sampleSize;var c=[],d=0;while(d<a){var e=b.parseBox();switch(e.getType()){case"vttc":c=[].concat(c,l(e,b));d+=e.getSize();b.skipBox(e);break;case"vtte":c.push(null);d+=e.getSize();b.skipBox(e);break;default:b.skipBox(e)}}return c}function l(a,b){var c=[],d;while(b.withinBox(a)){var e=b.parseBox();switch(e.getType()){case"payl":d=b.readBoxBodyText(e);c.push(d.endsWith("\0")?d.substring(0,d.indexOf("\0")).trim():d.trim());b.skipBox(e);break;default:b.skipBox(e)}}return c}g["default"]=a}),98);
__d("VideoPlayerHTML5ApiCea608State",["Bootloader","Deferred","FBLogger"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=this,d=a.onReady,e=a.onCaptionsLoaded,f=a.captionsDisplay;this.$1=null;this.$2=[];this.$3=null;this.$4={changedCount:0,dequeuedCount:0,erroredCount:0,processedCount:0,processStartedCount:0,queuedCount:0};this.source=null;this.captionsDisplay=null;this.$1=c("Bootloader").loadModules(["VideoPlayerCea608CaptionsSource"],function(a){a=new a({onCaptionsLoaded:e,onCaptionsChanged:function(a,c){b.$4.changedCount++,b.captionsDisplay&&b.captionsDisplay.handleCaptionsChanged(a,c)}});b.source=a;b.captionsDisplay=f;d(b)},"VideoPlayerHTML5ApiCea608State")}var b=a.prototype;b.enqueueBytes=function(a){this.$4.queuedCount++,this.$2.push(a),this.$5()};b.processQueue=function(){this.$5()};b.getStats=function(){return this.$4};b.getCurrentScreenRepresentation=function(){return this.source?this.source.getCurrentScreenRepresentation():null};b.destroy=function(){this.$1&&(this.$1.remove(),this.$1=null),this.captionsDisplay&&(this.captionsDisplay.destroy(),this.captionsDisplay=null),this.source&&(this.source.destroy(),this.source=null),this.$4={changedCount:0,dequeuedCount:0,erroredCount:0,processedCount:0,processStartedCount:0,queuedCount:0}};b.$5=function(){var a=this,b=this.source;if(!b)return;var d=this.$2,e=this.$3,f=function(){var f=d.shift();if(!e){var g=new(c("Deferred"))();g.resolve();e=g.getPromise()}a.$4.dequeuedCount++;a.$3=e=e.then(function(){a.$4.processStartedCount++;return b.processBytes(f).then(function(){a.$4.processedCount++})["catch"](function(b){a.$4.erroredCount++,c("FBLogger")("video").catching(b).mustfix("[VideoPlayerHTML5ApiCea608State] Caught error from CEA-608 source processBytes")})})};while(d.length)f()};return a}();g["default"]=a}),98);